/* eslint-disable @angular-eslint/component-class-suffix */
import { Component, Input } from '@angular/core';
import { StarRatingUtils } from './star-rating.utils';
import * as i0 from "@angular/core";
import * as i1 from "./star-rating-config.service";
export class StarRating {
    config;
    //CTRL ONLY
    ///////////////////////////////////////////////////////////////////////////////////////////
    classEmpty;
    classHalf;
    classFilled;
    pathEmpty;
    pathHalf;
    pathFilled;
    color;
    stars;
    ratingAsInteger;
    halfStarVisible;
    /**
     * showHalfStars
     */
    _showHalfStars;
    get showHalfStars() {
        return this._showHalfStars;
    }
    set showHalfStars(value) {
        this._showHalfStars = !!value;
        //update halfStarVisible
        this.setHalfStarVisible();
    }
    /**
     * getColor
     */
    getColor;
    /////////////////////////////////////////////
    /**
     * getHalfStarVisible
     */
    getHalfStarVisible;
    /////////////////////////////////////////////
    //Inputs
    ///////////////////////////////////////////////////////////////////////////////////////////
    /**
     * id property to identify the DOM element
     */
    _id;
    get id() {
        return this._id;
    }
    set id(value) {
        this._id = value || '';
    }
    /////////////////////////////////////////////
    /**
     * focus
     */
    _focus;
    get focus() {
        return this._focus;
    }
    set focus(value) {
        this._focus = !!value;
    }
    /////////////////////////////////////////////
    /**
     * labelText
     */
    _labelText;
    get labelText() {
        return this._labelText;
    }
    set labelText(value) {
        this._labelText = value;
    }
    /////////////////////////////////////////////
    /**
     * labelPosition
     */
    _labelPosition;
    get labelPosition() {
        return this._labelPosition;
    }
    set labelPosition(value) {
        this._labelPosition = value || this.config.labelPosition;
    }
    /////////////////////////////////////////////
    /**
     * labelVisible
     */
    _labelVisible;
    get labelVisible() {
        return this._labelVisible;
    }
    set labelVisible(value) {
        this._labelVisible = !!value;
    }
    /////////////////////////////////////////////
    /**
     * hoverEnabled
     */
    _hoverEnabled;
    get hoverEnabled() {
        return this._hoverEnabled;
    }
    set hoverEnabled(value) {
        this._hoverEnabled = value !== undefined ? !!value : false;
    }
    /////////////////////////////////////////////
    /**
     * staticColor
     */
    _staticColor;
    get staticColor() {
        return this._staticColor || this.config.staticColor || undefined;
    }
    set staticColor(value) {
        this._staticColor = value;
        //update color.
        this.setColor();
    }
    /////////////////////////////////////////////
    /**
     * direction
     */
    _direction;
    get direction() {
        return this._direction;
    }
    set direction(value) {
        this._direction = value || undefined;
    }
    /////////////////////////////////////////////
    /**
     * numOfStars
     */
    _numOfStars;
    get numOfStars() {
        return this._numOfStars;
    }
    set numOfStars(value) {
        this._numOfStars = value > 0 ? value : this.config.numOfStars;
        //update stars array
        this.stars = StarRatingUtils.getStarsArray(this.numOfStars);
        //update color
        this.setColor();
    }
    /////////////////////////////////////////////
    /**
     * hoverRating
     */
    _hoverRating;
    get hoverRating() {
        return this._hoverRating;
    }
    set hoverRating(value) {
        this._hoverRating = value > 0 ? value : 0;
    }
    /////////////////////////////////////////////
    /**
     * speed
     */
    _speed;
    get speed() {
        return this._speed;
    }
    set speed(value) {
        this._speed = value || this.config.speed;
    }
    /////////////////////////////////////////////
    /**
     * size
     */
    _size;
    get size() {
        return this._size || this.config.size;
    }
    set size(value) {
        this._size = value;
    }
    /////////////////////////////////////////////
    /**
     * starType
     */
    _starType;
    get starType() {
        return this._starType || this.config.starType;
    }
    set starType(value) {
        this._starType = value;
    }
    /////////////////////////////////////////////
    /**
     * space
     */
    _space;
    get space() {
        return this._space;
    }
    set space(value) {
        this._space = value;
    }
    /////////////////////////////////////////////
    /**
     * readOnly
     */
    _readOnly;
    get readOnly() {
        return this._readOnly;
    }
    set readOnly(value) {
        this._readOnly = !!value;
    }
    /////////////////////////////////////////////
    /**
     * disabled
     */
    _disabled;
    get disabled() {
        return this._disabled;
    }
    set disabled(value) {
        this._disabled = !!value;
    }
    /////////////////////////////////////////////
    _step;
    get step() {
        return this._step;
    }
    set step(value) {
        this._step = value > 0 ? value : 1;
    }
    /////////////////////////////////////////////
    /**
     * rating
     */
    _rating;
    get rating() {
        return this._rating;
    }
    set rating(value) {
        this.setRating(value);
    }
    /**
     * setRating
     * I use a setter function instead of a set method to enable overrides for this function.
     * @param value
     */
    setRating(value) {
        //validate and apply newRating
        let newRating = 0;
        if (value >= 0 && value <= this.numOfStars) {
            newRating = value;
        }
        //limit max value to max number of stars
        if (value > this.numOfStars) {
            newRating = this.numOfStars;
        }
        this._rating = newRating;
        //update ratingAsInteger. rating parsed to int for the value-[n] modifier
        this.ratingAsInteger = parseInt(this._rating?.toString(), 10);
        //update halfStarsVisible
        this.setHalfStarVisible();
        //update calculated Color
        this.setColor();
    }
    constructor(config) {
        this.config = config;
        //set default ctrl props
        this.classEmpty = this.config.classEmpty;
        this.classHalf = this.config.classHalf;
        this.classFilled = this.config.classFilled;
        this.pathEmpty = this.config.svgPathEmpty;
        this.pathHalf = this.config.svgPathHalf;
        this.pathFilled = this.config.svgPathFilled;
        //set default Component Inputs
        if ('getColor' in this.config &&
            typeof this.config.getColor === 'function') {
            this.getColor = this.config.getColor;
        }
        if ('getHalfStarVisible' in this.config &&
            typeof this.config.getHalfStarVisible === 'function') {
            this.getHalfStarVisible = this.config.getHalfStarVisible;
        }
        this.numOfStars = this.config.numOfStars;
        this.rating = 0;
        this.step = 1;
    }
    svgVisible() {
        return this.starType === 'svg';
    }
    interactionPossible() {
        return !this.readOnly && !this.disabled;
    }
    setColor(useHoverValue = false) {
        //check if custom function is given
        const ratingValue = useHoverValue ? this.hoverRating : this.rating;
        if (typeof this.getColor === 'function') {
            this.color = this.getColor(ratingValue, this.numOfStars, this.staticColor);
        }
        else {
            this.color = StarRatingUtils.getColor(ratingValue, this.numOfStars, this.staticColor);
        }
    }
    setHalfStarVisible() {
        //update halfStarVisible
        if (this.showHalfStars) {
            //check if custom function is given
            if (typeof this.getHalfStarVisible === 'function') {
                this.halfStarVisible = this.getHalfStarVisible(this.rating);
            }
            else {
                this.halfStarVisible = StarRatingUtils.getHalfStarVisible(this.rating);
            }
        }
        else {
            this.halfStarVisible = false;
        }
    }
    getComponentClassNames() {
        const classNames = [];
        classNames.push(this.rating ? 'value-' + this.ratingAsInteger : 'value-0');
        classNames.push(this.halfStarVisible ? 'half' : '');
        classNames.push(this.hoverEnabled ? 'hover' : '');
        const hoverRating = this.hoverRating
            ? 'hover-' + this.hoverRating
            : 'hover-0';
        classNames.push(this.hoverEnabled ? hoverRating : '');
        classNames.push(this.space ? 'space-' + this.space : '');
        classNames.push(this.labelPosition ? 'label-' + this.labelPosition : '');
        classNames.push(this.color ? 'color-' + this.color : '');
        classNames.push(this.starType ? 'star-' + this.starType : '');
        classNames.push(this.speed);
        classNames.push(this.size);
        classNames.push(this.readOnly ? 'read-only' : '');
        classNames.push(this.disabled ? 'disabled' : '');
        classNames.push(this.direction ? 'direction-' + this.direction : '');
        return classNames.join(' ');
    }
    increment() {
        //increment to next higher step
        const absDiff = Math.abs(this.rating % this.step);
        this.rating = this.rating + (absDiff > 0 ? this.step - absDiff : this.step);
    }
    decrement() {
        //decrement to next lower step
        const absDiff = Math.abs(this.rating % this.step);
        this.rating = this.rating - (absDiff > 0 ? absDiff : this.step);
    }
    reset() {
        this.rating = 0;
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.8", ngImport: i0, type: StarRating, deps: [{ token: i1.StarRatingConfigService }], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.8", type: StarRating, selector: "placeholder-star-rating", inputs: { showHalfStars: "showHalfStars", id: "id", focus: "focus", labelText: "labelText", labelPosition: "labelPosition", labelVisible: "labelVisible", hoverEnabled: "hoverEnabled", staticColor: "staticColor", direction: "direction", numOfStars: "numOfStars", hoverRating: "hoverRating", speed: "speed", size: "size", starType: "starType", space: "space", readOnly: "readOnly", disabled: "disabled", step: "step", rating: "rating" }, ngImport: i0, template: ``, isInline: true });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.8", ngImport: i0, type: StarRating, decorators: [{
            type: Component,
            args: [{
                    // Metadata needed for Angular.
                    template: ``,
                    selector: 'placeholder-star-rating'
                }]
        }], ctorParameters: function () { return [{ type: i1.StarRatingConfigService }]; }, propDecorators: { showHalfStars: [{
                type: Input
            }], id: [{
                type: Input
            }], focus: [{
                type: Input
            }], labelText: [{
                type: Input
            }], labelPosition: [{
                type: Input
            }], labelVisible: [{
                type: Input
            }], hoverEnabled: [{
                type: Input
            }], staticColor: [{
                type: Input
            }], direction: [{
                type: Input
            }], numOfStars: [{
                type: Input
            }], hoverRating: [{
                type: Input
            }], speed: [{
                type: Input
            }], size: [{
                type: Input
            }], starType: [{
                type: Input
            }], space: [{
                type: Input
            }], readOnly: [{
                type: Input
            }], disabled: [{
                type: Input
            }], step: [{
                type: Input
            }], rating: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3Rhci1yYXRpbmcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL2FuZ3VsYXItc3Rhci1yYXRpbmcvc3JjL2xpYi9zZXJ2aWNlcy9zdGFyLXJhdGluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwyREFBMkQ7QUFDM0QsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFhakQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDOzs7QUFPdEQsTUFBTSxPQUFPLFVBQVU7SUFDWCxNQUFNLENBQW1CO0lBRW5DLFdBQVc7SUFDWCwyRkFBMkY7SUFDM0YsVUFBVSxDQUFTO0lBQ25CLFNBQVMsQ0FBUztJQUNsQixXQUFXLENBQVM7SUFFcEIsU0FBUyxDQUFTO0lBQ2xCLFFBQVEsQ0FBUztJQUNqQixVQUFVLENBQVM7SUFFbkIsS0FBSyxDQUFrQjtJQUN2QixLQUFLLENBQWdCO0lBQ3JCLGVBQWUsQ0FBUztJQUN4QixlQUFlLENBQVU7SUFFekI7O09BRUc7SUFDTyxjQUFjLENBQVU7SUFDbEMsSUFBSSxhQUFhO1FBQ2YsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDO0lBQzdCLENBQUM7SUFFRCxJQUFhLGFBQWEsQ0FBQyxLQUFjO1FBQ3ZDLElBQUksQ0FBQyxjQUFjLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQztRQUU5Qix3QkFBd0I7UUFDeEIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7SUFDNUIsQ0FBQztJQUVEOztPQUVHO0lBQ0gsUUFBUSxDQUlhO0lBRXJCLDZDQUE2QztJQUU3Qzs7T0FFRztJQUNILGtCQUFrQixDQUE4QjtJQUNoRCw2Q0FBNkM7SUFFN0MsUUFBUTtJQUNSLDJGQUEyRjtJQUUzRjs7T0FFRztJQUNPLEdBQUcsQ0FBUztJQUN0QixJQUFJLEVBQUU7UUFDSixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDbEIsQ0FBQztJQUVELElB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S0FBSztnQkFpQk8sU0FBUztzQkFBckIsS0FBSztnQkFjTyxVQUFVO3NCQUF0QixLQUFLO2dCQW9CTyxXQUFXO3NCQUF2QixLQUFLO2dCQWNPLEtBQUs7c0JBQWpCLEtBQUs7Z0JBY08sSUFBSTtzQkFBaEIsS0FBSztnQkFjTyxRQUFRO3NCQUFwQixLQUFLO2dCQWNPLEtBQUs7c0JBQWpCLEtBQUs7Z0JBY08sUUFBUTtzQkFBcEIsS0FBSztnQkFjTyxRQUFRO3NCQUFwQixLQUFLO2dCQVdPLElBQUk7c0JBQWhCLEtBQUs7Z0JBY08sTUFBTTtzQkFBbEIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIEBhbmd1bGFyLWVzbGludC9jb21wb25lbnQtY2xhc3Mtc3VmZml4ICovXG5pbXBvcnQgeyBDb21wb25lbnQsIElucHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7XG4gIFN0YXJSYXRpbmdDb25maWcsXG4gIHN0YXJSYXRpbmdDb2xvcixcbiAgc3RhclJhdGluZ0RpcmVjdGlvbixcbiAgc3RhclJhdGluZ0xhYmVsUG9zaXRpb24sXG4gIHN0YXJSYXRpbmdTaXplcyxcbiAgc3RhclJhdGluZ1NwZWVkLFxuICBzdGFyUmF0aW5nU3RhclNwYWNlLFxuICBzdGFyUmF0aW5nU3RhclR5cGVzLFxufSBmcm9tICcuLi9pbnRlcmZhY2VzL3N0YXItcmF0aW5nLWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgU3RhclJhdGluZ0NvbmZpZ1NlcnZpY2UgfSBmcm9tICcuL3N0YXItcmF0aW5nLWNvbmZpZy5zZXJ2aWNlJztcbmltcG9ydCB7IFN0YXJSYXRpbmdVdGlscyB9IGZyb20gJy4vc3Rhci1yYXRpbmcudXRpbHMnO1xuXG5AQ29tcG9uZW50KHtcbiAgLy8gTWV0YWRhdGEgbmVlZGVkIGZvciBBbmd1bGFyLlxuICB0ZW1wbGF0ZTogYGAsXG4gIHNlbGVjdG9yOiAncGxhY2Vob2xkZXItc3Rhci1yYXRpbmcnXG59KVxuZXhwb3J0IGNsYXNzIFN0YXJSYXRpbmcge1xuICBwcm90ZWN0ZWQgY29uZmlnOiBTdGFyUmF0aW5nQ29uZmlnO1xuXG4gIC8vQ1RSTCBPTkxZXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgY2xhc3NFbXB0eTogc3RyaW5nO1xuICBjbGFzc0hhbGY6IHN0cmluZztcbiAgY2xhc3NGaWxsZWQ6IHN0cmluZztcblxuICBwYXRoRW1wdHk6IHN0cmluZztcbiAgcGF0aEhhbGY6IHN0cmluZztcbiAgcGF0aEZpbGxlZDogc3RyaW5nO1xuXG4gIGNvbG9yOiBzdGFyUmF0aW5nQ29sb3I7XG4gIHN0YXJzOiBBcnJheTxudW1iZXI+O1xuICByYXRpbmdBc0ludGVnZXI6IG51bWJlcjtcbiAgaGFsZlN0YXJWaXNpYmxlOiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBzaG93SGFsZlN0YXJzXG4gICAqL1xuICBwcm90ZWN0ZWQgX3Nob3dIYWxmU3RhcnM6IGJvb2xlYW47XG4gIGdldCBzaG93SGFsZlN0YXJzKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9zaG93SGFsZlN0YXJzO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHNob3dIYWxmU3RhcnModmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9zaG93SGFsZlN0YXJzID0gISF2YWx1ZTtcblxuICAgIC8vdXBkYXRlIGhhbGZTdGFyVmlzaWJsZVxuICAgIHRoaXMuc2V0SGFsZlN0YXJWaXNpYmxlKCk7XG4gIH1cblxuICAvKipcbiAgICogZ2V0Q29sb3JcbiAgICovXG4gIGdldENvbG9yOiAoXG4gICAgcmF0aW5nOiBudW1iZXIsXG4gICAgbnVtT2ZTdGFyczogbnVtYmVyLFxuICAgIHN0YXRpY0NvbG9yPzogc3RhclJhdGluZ0NvbG9yXG4gICkgPT4gc3RhclJhdGluZ0NvbG9yO1xuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBnZXRIYWxmU3RhclZpc2libGVcbiAgICovXG4gIGdldEhhbGZTdGFyVmlzaWJsZTogKHJhdGluZzogbnVtYmVyKSA9PiBib29sZWFuO1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvL0lucHV0c1xuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGlkIHByb3BlcnR5IHRvIGlkZW50aWZ5IHRoZSBET00gZWxlbWVudFxuICAgKi9cbiAgcHJvdGVjdGVkIF9pZDogc3RyaW5nO1xuICBnZXQgaWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5faWQ7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgaWQodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuX2lkID0gdmFsdWUgfHwgJyc7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogZm9jdXNcbiAgICovXG4gIHByb3RlY3RlZCBfZm9jdXM6IGJvb2xlYW47XG4gIGdldCBmb2N1cygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fZm9jdXM7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgZm9jdXModmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9mb2N1cyA9ICEhdmFsdWU7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogbGFiZWxUZXh0XG4gICAqL1xuICBwcm90ZWN0ZWQgX2xhYmVsVGV4dDogc3RyaW5nO1xuICBnZXQgbGFiZWxUZXh0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2xhYmVsVGV4dDtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBsYWJlbFRleHQodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuX2xhYmVsVGV4dCA9IHZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGxhYmVsUG9zaXRpb25cbiAgICovXG4gIHByb3RlY3RlZCBfbGFiZWxQb3NpdGlvbjogc3RhclJhdGluZ0xhYmVsUG9zaXRpb247XG4gIGdldCBsYWJlbFBvc2l0aW9uKCk6IHN0YXJSYXRpbmdMYWJlbFBvc2l0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5fbGFiZWxQb3NpdGlvbjtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBsYWJlbFBvc2l0aW9uKHZhbHVlOiBzdGFyUmF0aW5nTGFiZWxQb3NpdGlvbikge1xuICAgIHRoaXMuX2xhYmVsUG9zaXRpb24gPSB2YWx1ZSB8fCB0aGlzLmNvbmZpZy5sYWJlbFBvc2l0aW9uO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGxhYmVsVmlzaWJsZVxuICAgKi9cbiAgcHJvdGVjdGVkIF9sYWJlbFZpc2libGU6IGJvb2xlYW47XG4gIGdldCBsYWJlbFZpc2libGUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2xhYmVsVmlzaWJsZTtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBsYWJlbFZpc2libGUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9sYWJlbFZpc2libGUgPSAhIXZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGhvdmVyRW5hYmxlZFxuICAgKi9cbiAgcHJvdGVjdGVkIF9ob3ZlckVuYWJsZWQ6IGJvb2xlYW47XG4gIGdldCBob3ZlckVuYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2hvdmVyRW5hYmxlZDtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBob3ZlckVuYWJsZWQodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9ob3ZlckVuYWJsZWQgPSB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gISF2YWx1ZSA6IGZhbHNlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIHN0YXRpY0NvbG9yXG4gICAqL1xuICBwcm90ZWN0ZWQgX3N0YXRpY0NvbG9yOiBzdGFyUmF0aW5nQ29sb3I7XG4gIGdldCBzdGF0aWNDb2xvcigpOiBzdGFyUmF0aW5nQ29sb3Ige1xuICAgIHJldHVybiB0aGlzLl9zdGF0aWNDb2xvciB8fCB0aGlzLmNvbmZpZy5zdGF0aWNDb2xvciB8fCB1bmRlZmluZWQ7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgc3RhdGljQ29sb3IodmFsdWU6IHN0YXJSYXRpbmdDb2xvcikge1xuICAgIHRoaXMuX3N0YXRpY0NvbG9yID0gdmFsdWU7XG5cbiAgICAvL3VwZGF0ZSBjb2xvci5cbiAgICB0aGlzLnNldENvbG9yKCk7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogZGlyZWN0aW9uXG4gICAqL1xuICBwcm90ZWN0ZWQgX2RpcmVjdGlvbjogc3RhclJhdGluZ0RpcmVjdGlvbjtcbiAgZ2V0IGRpcmVjdGlvbigpOiBzdGFyUmF0aW5nRGlyZWN0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGRpcmVjdGlvbih2YWx1ZTogc3RhclJhdGluZ0RpcmVjdGlvbikge1xuICAgIHRoaXMuX2RpcmVjdGlvbiA9IHZhbHVlIHx8IHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBudW1PZlN0YXJzXG4gICAqL1xuICBwcm90ZWN0ZWQgX251bU9mU3RhcnM6IG51bWJlcjtcbiAgZ2V0IG51bU9mU3RhcnMoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fbnVtT2ZTdGFycztcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBudW1PZlN0YXJzKHZhbHVlOiBudW1iZXIpIHtcbiAgICB0aGlzLl9udW1PZlN0YXJzID0gdmFsdWUgPiAwID8gdmFsdWUgOiB0aGlzLmNvbmZpZy5udW1PZlN0YXJzITtcblxuICAgIC8vdXBkYXRlIHN0YXJzIGFycmF5XG4gICAgdGhpcy5zdGFycyA9IFN0YXJSYXRpbmdVdGlscy5nZXRTdGFyc0FycmF5KHRoaXMubnVtT2ZTdGFycyk7XG5cbiAgICAvL3VwZGF0ZSBjb2xvclxuICAgIHRoaXMuc2V0Q29sb3IoKTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBob3ZlclJhdGluZ1xuICAgKi9cbiAgcHJvdGVjdGVkIF9ob3ZlclJhdGluZzogbnVtYmVyO1xuICBnZXQgaG92ZXJSYXRpbmcoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5faG92ZXJSYXRpbmc7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgaG92ZXJSYXRpbmcodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX2hvdmVyUmF0aW5nID0gdmFsdWUgPiAwID8gdmFsdWUgOiAwO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIHNwZWVkXG4gICAqL1xuICBwcm90ZWN0ZWQgX3NwZWVkOiBzdGFyUmF0aW5nU3BlZWQ7XG4gIGdldCBzcGVlZCgpOiBzdGFyUmF0aW5nU3BlZWQge1xuICAgIHJldHVybiB0aGlzLl9zcGVlZDtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBzcGVlZCh2YWx1ZTogc3RhclJhdGluZ1NwZWVkKSB7XG4gICAgdGhpcy5fc3BlZWQgPSB2YWx1ZSB8fCB0aGlzLmNvbmZpZy5zcGVlZDtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBzaXplXG4gICAqL1xuICBwcm90ZWN0ZWQgX3NpemU6IHN0YXJSYXRpbmdTaXplcztcbiAgZ2V0IHNpemUoKTogc3RhclJhdGluZ1NpemVzIHtcbiAgICByZXR1cm4gdGhpcy5fc2l6ZSB8fCB0aGlzLmNvbmZpZy5zaXplO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHNpemUodmFsdWU6IHN0YXJSYXRpbmdTaXplcykge1xuICAgIHRoaXMuX3NpemUgPSB2YWx1ZTtcbiAgfVxuXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIC8qKlxuICAgKiBzdGFyVHlwZVxuICAgKi9cbiAgcHJvdGVjdGVkIF9zdGFyVHlwZTogc3RhclJhdGluZ1N0YXJUeXBlcztcbiAgZ2V0IHN0YXJUeXBlKCk6IHN0YXJSYXRpbmdTdGFyVHlwZXMge1xuICAgIHJldHVybiB0aGlzLl9zdGFyVHlwZSB8fCB0aGlzLmNvbmZpZy5zdGFyVHlwZTtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCBzdGFyVHlwZSh2YWx1ZTogc3RhclJhdGluZ1N0YXJUeXBlcykge1xuICAgIHRoaXMuX3N0YXJUeXBlID0gdmFsdWU7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogc3BhY2VcbiAgICovXG4gIHByb3RlY3RlZCBfc3BhY2U6IHN0YXJSYXRpbmdTdGFyU3BhY2U7XG4gIGdldCBzcGFjZSgpOiBzdGFyUmF0aW5nU3RhclNwYWNlIHtcbiAgICByZXR1cm4gdGhpcy5fc3BhY2U7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgc3BhY2UodmFsdWU6IHN0YXJSYXRpbmdTdGFyU3BhY2UpIHtcbiAgICB0aGlzLl9zcGFjZSA9IHZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIHJlYWRPbmx5XG4gICAqL1xuICBwcm90ZWN0ZWQgX3JlYWRPbmx5OiBib29sZWFuO1xuICBnZXQgcmVhZE9ubHkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3JlYWRPbmx5O1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHJlYWRPbmx5KHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fcmVhZE9ubHkgPSAhIXZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgLyoqXG4gICAqIGRpc2FibGVkXG4gICAqL1xuICBwcm90ZWN0ZWQgX2Rpc2FibGVkOiBib29sZWFuO1xuICBnZXQgZGlzYWJsZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2Rpc2FibGVkO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGRpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5fZGlzYWJsZWQgPSAhIXZhbHVlO1xuICB9XG5cbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgcHJpdmF0ZSBfc3RlcDogbnVtYmVyO1xuICBnZXQgc3RlcCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9zdGVwO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IHN0ZXAodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuX3N0ZXAgPSB2YWx1ZSA+IDAgPyB2YWx1ZSA6IDE7XG4gIH1cblxuICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAvKipcbiAgICogcmF0aW5nXG4gICAqL1xuICBwcm90ZWN0ZWQgX3JhdGluZzogbnVtYmVyO1xuICBnZXQgcmF0aW5nKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX3JhdGluZztcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCByYXRpbmcodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuc2V0UmF0aW5nKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBzZXRSYXRpbmdcbiAgICogSSB1c2UgYSBzZXR0ZXIgZnVuY3Rpb24gaW5zdGVhZCBvZiBhIHNldCBtZXRob2QgdG8gZW5hYmxlIG92ZXJyaWRlcyBmb3IgdGhpcyBmdW5jdGlvbi5cbiAgICogQHBhcmFtIHZhbHVlXG4gICAqL1xuICBzZXRSYXRpbmcodmFsdWU6IG51bWJlcikge1xuICAgIC8vdmFsaWRhdGUgYW5kIGFwcGx5IG5ld1JhdGluZ1xuICAgIGxldCBuZXdSYXRpbmcgPSAwO1xuICAgIGlmICh2YWx1ZSA+PSAwICYmIHZhbHVlIDw9IHRoaXMubnVtT2ZTdGFycykge1xuICAgICAgbmV3UmF0aW5nID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLy9saW1pdCBtYXggdmFsdWUgdG8gbWF4IG51bWJlciBvZiBzdGFyc1xuICAgIGlmICh2YWx1ZSA+IHRoaXMubnVtT2ZTdGFycykge1xuICAgICAgbmV3UmF0aW5nID0gdGhpcy5udW1PZlN0YXJzO1xuICAgIH1cbiAgICB0aGlzLl9yYXRpbmcgPSBuZXdSYXRpbmc7XG5cbiAgICAvL3VwZGF0ZSByYXRpbmdBc0ludGVnZXIuIHJhdGluZyBwYXJzZWQgdG8gaW50IGZvciB0aGUgdmFsdWUtW25dIG1vZGlmaWVyXG4gICAgdGhpcy5yYXRpbmdBc0ludGVnZXIgPSBwYXJzZUludCh0aGlzLl9yYXRpbmc/LnRvU3RyaW5nKCksIDEwKTtcblxuICAgIC8vdXBkYXRlIGhhbGZTdGFyc1Zpc2libGVcbiAgICB0aGlzLnNldEhhbGZTdGFyVmlzaWJsZSgpO1xuXG4gICAgLy91cGRhdGUgY2FsY3VsYXRlZCBDb2xvclxuICAgIHRoaXMuc2V0Q29sb3IoKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogU3RhclJhdGluZ0NvbmZpZ1NlcnZpY2UpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcblxuICAgIC8vc2V0IGRlZmF1bHQgY3RybCBwcm9wc1xuICAgIHRoaXMuY2xhc3NFbXB0eSA9IHRoaXMuY29uZmlnLmNsYXNzRW1wdHkhO1xuICAgIHRoaXMuY2xhc3NIYWxmID0gdGhpcy5jb25maWcuY2xhc3NIYWxmITtcbiAgICB0aGlzLmNsYXNzRmlsbGVkID0gdGhpcy5jb25maWcuY2xhc3NGaWxsZWQhO1xuICAgIHRoaXMucGF0aEVtcHR5ID0gdGhpcy5jb25maWcuc3ZnUGF0aEVtcHR5ITtcbiAgICB0aGlzLnBhdGhIYWxmID0gdGhpcy5jb25maWcuc3ZnUGF0aEhhbGYhO1xuICAgIHRoaXMucGF0aEZpbGxlZCA9IHRoaXMuY29uZmlnLnN2Z1BhdGhGaWxsZWQhO1xuXG4gICAgLy9zZXQgZGVmYXVsdCBDb21wb25lbnQgSW5wdXRzXG4gICAgaWYgKFxuICAgICAgJ2dldENvbG9yJyBpbiB0aGlzLmNvbmZpZyAmJlxuICAgICAgdHlwZW9mIHRoaXMuY29uZmlnLmdldENvbG9yID09PSAnZnVuY3Rpb24nXG4gICAgKSB7XG4gICAgICB0aGlzLmdldENvbG9yID0gdGhpcy5jb25maWcuZ2V0Q29sb3I7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgJ2dldEhhbGZTdGFyVmlzaWJsZScgaW4gdGhpcy5jb25maWcgJiZcbiAgICAgIHR5cGVvZiB0aGlzLmNvbmZpZy5nZXRIYWxmU3RhclZpc2libGUgPT09ICdmdW5jdGlvbidcbiAgICApIHtcbiAgICAgIHRoaXMuZ2V0SGFsZlN0YXJWaXNpYmxlID0gdGhpcy5jb25maWcuZ2V0SGFsZlN0YXJWaXNpYmxlO1xuICAgIH1cblxuICAgIHRoaXMubnVtT2ZTdGFycyA9IHRoaXMuY29uZmlnLm51bU9mU3RhcnMhO1xuICAgIHRoaXMucmF0aW5nID0gMDtcbiAgICB0aGlzLnN0ZXAgPSAxO1xuICB9XG5cbiAgc3ZnVmlzaWJsZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5zdGFyVHlwZSA9PT0gJ3N2Zyc7XG4gIH1cblxuICBpbnRlcmFjdGlvblBvc3NpYmxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhdGhpcy5yZWFkT25seSAmJiAhdGhpcy5kaXNhYmxlZDtcbiAgfVxuXG4gIHNldENvbG9yKHVzZUhvdmVyVmFsdWUgPSBmYWxzZSk6IHZvaWQge1xuICAgIC8vY2hlY2sgaWYgY3VzdG9tIGZ1bmN0aW9uIGlzIGdpdmVuXG4gICAgY29uc3QgcmF0aW5nVmFsdWUgPSB1c2VIb3ZlclZhbHVlID8gdGhpcy5ob3ZlclJhdGluZyA6IHRoaXMucmF0aW5nO1xuICAgIGlmICh0eXBlb2YgdGhpcy5nZXRDb2xvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhpcy5jb2xvciA9IHRoaXMuZ2V0Q29sb3IoXG4gICAgICAgIHJhdGluZ1ZhbHVlLFxuICAgICAgICB0aGlzLm51bU9mU3RhcnMsXG4gICAgICAgIHRoaXMuc3RhdGljQ29sb3JcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29sb3IgPSBTdGFyUmF0aW5nVXRpbHMuZ2V0Q29sb3IoXG4gICAgICAgIHJhdGluZ1ZhbHVlLFxuICAgICAgICB0aGlzLm51bU9mU3RhcnMsXG4gICAgICAgIHRoaXMuc3RhdGljQ29sb3JcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgc2V0SGFsZlN0YXJWaXNpYmxlKCk6IHZvaWQge1xuICAgIC8vdXBkYXRlIGhhbGZTdGFyVmlzaWJsZVxuICAgIGlmICh0aGlzLnNob3dIYWxmU3RhcnMpIHtcbiAgICAgIC8vY2hlY2sgaWYgY3VzdG9tIGZ1bmN0aW9uIGlzIGdpdmVuXG4gICAgICBpZiAodHlwZW9mIHRoaXMuZ2V0SGFsZlN0YXJWaXNpYmxlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMuaGFsZlN0YXJWaXNpYmxlID0gdGhpcy5nZXRIYWxmU3RhclZpc2libGUodGhpcy5yYXRpbmcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5oYWxmU3RhclZpc2libGUgPSBTdGFyUmF0aW5nVXRpbHMuZ2V0SGFsZlN0YXJWaXNpYmxlKHRoaXMucmF0aW5nKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oYWxmU3RhclZpc2libGUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBnZXRDb21wb25lbnRDbGFzc05hbWVzKCk6IHN0cmluZyB7XG4gICAgY29uc3QgY2xhc3NOYW1lczogc3RyaW5nW10gPSBbXTtcblxuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLnJhdGluZyA/ICd2YWx1ZS0nICsgdGhpcy5yYXRpbmdBc0ludGVnZXIgOiAndmFsdWUtMCcpO1xuICAgIGNsYXNzTmFtZXMucHVzaCh0aGlzLmhhbGZTdGFyVmlzaWJsZSA/ICdoYWxmJyA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5ob3ZlckVuYWJsZWQgPyAnaG92ZXInIDogJycpO1xuXG4gICAgY29uc3QgaG92ZXJSYXRpbmcgPSB0aGlzLmhvdmVyUmF0aW5nXG4gICAgICA/ICdob3Zlci0nICsgdGhpcy5ob3ZlclJhdGluZ1xuICAgICAgOiAnaG92ZXItMCc7XG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMuaG92ZXJFbmFibGVkID8gaG92ZXJSYXRpbmcgOiAnJyk7XG5cbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5zcGFjZSA/ICdzcGFjZS0nICsgdGhpcy5zcGFjZSA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5sYWJlbFBvc2l0aW9uID8gJ2xhYmVsLScgKyB0aGlzLmxhYmVsUG9zaXRpb24gOiAnJyk7XG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMuY29sb3IgPyAnY29sb3ItJyArIHRoaXMuY29sb3IgOiAnJyk7XG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMuc3RhclR5cGUgPyAnc3Rhci0nICsgdGhpcy5zdGFyVHlwZSA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5zcGVlZCk7XG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMuc2l6ZSk7XG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMucmVhZE9ubHkgPyAncmVhZC1vbmx5JyA6ICcnKTtcbiAgICBjbGFzc05hbWVzLnB1c2godGhpcy5kaXNhYmxlZCA/ICdkaXNhYmxlZCcgOiAnJyk7XG4gICAgY2xhc3NOYW1lcy5wdXNoKHRoaXMuZGlyZWN0aW9uID8gJ2RpcmVjdGlvbi0nICsgdGhpcy5kaXJlY3Rpb24gOiAnJyk7XG5cbiAgICByZXR1cm4gY2xhc3NOYW1lcy5qb2luKCcgJyk7XG4gIH1cblxuICBpbmNyZW1lbnQoKSB7XG4gICAgLy9pbmNyZW1lbnQgdG8gbmV4dCBoaWdoZXIgc3RlcFxuICAgIGNvbnN0IGFic0RpZmYgPSBNYXRoLmFicyh0aGlzLnJhdGluZyAlIHRoaXMuc3RlcCk7XG4gICAgdGhpcy5yYXRpbmcgPSB0aGlzLnJhdGluZyArIChhYnNEaWZmID4gMCA/IHRoaXMuc3RlcCAtIGFic0RpZmYgOiB0aGlzLnN0ZXApO1xuICB9XG5cbiAgZGVjcmVtZW50KCkge1xuICAgIC8vZGVjcmVtZW50IHRvIG5leHQgbG93ZXIgc3RlcFxuICAgIGNvbnN0IGFic0RpZmYgPSBNYXRoLmFicyh0aGlzLnJhdGluZyAlIHRoaXMuc3RlcCk7XG4gICAgdGhpcy5yYXRpbmcgPSB0aGlzLnJhdGluZyAtIChhYnNEaWZmID4gMCA/IGFic0RpZmYgOiB0aGlzLnN0ZXApO1xuICB9XG5cbiAgcmVzZXQoKSB7XG4gICAgdGhpcy5yYXRpbmcgPSAwO1xuICB9XG59XG4iXX0=